{% extends "base.html" %}  <!-- Extiende la plantilla base -->

{% block content %}
<form action="{{url_for('editData')}}" method="POST">  <!-- Formulario que envía los datos al endpoint 'editData' usando el método POST -->
    <input type="hidden" name="nFestivosDataHidden" value="{{nFestivosData}}"/>  <!-- Campo oculto para el número de festivos -->
    <input type="hidden" name="nHorariosDataHidden" value="{{nHorariosData}}"/>  <!-- Campo oculto para el número de horarios -->
    <article class="tile is-child box p-6">
        <label><b>Editar Datos</b></label>  <!-- Etiqueta de encabezado para la sección de edición de datos -->
    </article>
    <div class="columns p-6">
        <div class="column is-half is-parent is-vertical p-6">
    <article class="tile is-child box p-6">
        <h3>Fecha</h3>
        <!-- Selectores personalizados para mes y año -->
        <select id="month" class="selector" onchange="updateYearMonth()">
            <option value="">Mes</option>
            <option value="01">Enero</option>
            <option value="02">Febrero</option>
            <option value="03">Marzo</option>
            <option value="04">Abril</option>
            <option value="05">Mayo</option>
            <option value="06">Junio</option>
            <option value="07">Julio</option>
            <option value="08">Agosto</option>
            <option value="09">Septiembre</option>
            <option value="10">Octubre</option>
            <option value="11">Noviembre</option>
            <option value="12">Diciembre</option>
        </select>
        <select id="year" class="selector" onchange="updateYearMonth()">
            <option value="">Año</option>
            <!-- Se pueden añadir más años según sea necesario -->
            <script>
                // Generar opciones de año dinámicamente
                const yearSelect = document.getElementById('year');
                for (let year = 2023; year <= 2100; year++) {
                    let option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    yearSelect.appendChild(option);
                }
            </script>
        </select>

        <input type="hidden" id="hiddenYear" name="year" value=""/>  <!-- Campo oculto para el año -->
        <input type="hidden" id="hiddenMonth" name="month" value=""/> <!-- Campo oculto para el mes -->
    </article>

    <script>
        function updateYearMonth() {
            const year = document.getElementById('year').value;
            const month = document.getElementById('month').value;
            document.getElementById('hiddenYear').value = year;
            document.getElementById('hiddenMonth').value = month;
        }
    </script>


            </article>
            <article class="tile is-child box p-6">
                                <h3>Festivos</h3>
                <div class="table-container">
                    <table class="table is-fullwidth is-striped">
                        <thead>
                        <th>Inicio</th>  <!-- Encabezado de la columna Inicio -->
                        <th>Fin</th>  <!-- Encabezado de la columna Fin -->
                        </thead>
                        {% for i in range(0, nFestivosData) %}  <!-- Bucle para iterar sobre los datos de festivos -->
                        <tr>
                            <td><input type="date" name="festIni{{i}}" value="{{festData[i]['st']}}" min="2023-1-1" max="2100-12-31"></td>  <!-- Campo de entrada para la fecha de inicio del festivo -->
                            <td><input type="date" name="festFin{{i}}" value="{{festData[i]['ed']}}" min="2023-1-1" max="2100-12-31"></td>  <!-- Campo de entrada para la fecha de fin del festivo -->
                        </tr>
                        {% endfor %}
                    </table>
                </div>
                <button class="button is-block is-info is-fullwidth" name="AddFestivoRow">Añadir Fila</button>  <!-- Botón para añadir una fila nueva a los festivos -->

            </article>

        </div>
        <div class="column is-half is-parent is-vertical p-6">
             <article class="tile is-child box p-6">
                <h3>Carpeta</h3>
                <input type="number" name="folder" value="{{folder}}" min=1 max=99/>  <!-- Campo de entrada para el número de folder con restricciones de mínimo y máximo -->
            </article>
            <article class="tile is-child box p-6">
  <h3>Horarios</h3>
                <div class="table-container">
                    <table class="table is-fullwidth is-striped">
                        <thead>
                        <th>Hora</th>  <!-- Encabezado de la columna Hora -->
                        <th>Duración</th>  <!-- Encabezado de la columna Duración -->
                        <th>Volumen</th>  <!-- Encabezado de la columna Volumen -->
                        </thead>
                        {% for i in range(0, nHorariosData) %}  <!-- Bucle para iterar sobre los datos de horarios -->
                        <tr>
                            <td><input type="time" name="time{{i}}" value="{{horariosData[i]['time']}}"/></td>  <!-- Campo de entrada para la hora del horario -->
                            <td><input type="text" name="rep{{i}}" value="{{horariosData[i]['rep']}}" title="segundos"/></td>  <!-- Campo de entrada para la duración del horario -->
                            <td><input type="range" name="vol{{i}}" value="{{horariosData[i]['vol']}}" min="5" max="30"/></td>  <!-- Campo de entrada para el volumen del horario -->
                        </tr>
                        {% endfor %}
                    </table>
                </div>
                <button class="button is-block is-info is-fullwidth" name="AddHorarioRow">Añadir Fila</button>  <!-- Botón para añadir una fila nueva a los horarios -->
            </article>

        </div>
    </div>
    <div class="box">
        <h2 class="subtitle has-text-black">Acciones</h2>
            <input type="hidden" name="nHorariosDataHidden" value="{{nHorariosData}}"/>  <!-- Campo oculto duplicado para el número de horarios -->
            <button class="button is-block is-info is-fullwidth" name="GoHome">Volver</button>  <!-- Botón para volver a la página anterior -->
            <button class="button is-block is-warning is-fullwidth" name="Apply">Aplicar cambios</button>  <!-- Botón para aplicar los cambios -->
            <button class="button is-block is-danger is-fullwidth" name="Reload">Recargar</button>  <!-- Botón para recargar la página -->
    </div>
</form>
{% endblock %}
